---
layout: post
title: "在阿里云上搭建Jekyll静态博客"
date: 2017-04-14 22:44:15
tags:
    - article
---

* toc
{:toc}

```
useradd ysmull
vi /etc/sudoers
ysmull        ALL=(ALL)      ALL
sudo apt-get install ruby ruby-dev
sudo gem install jekyll
ssh-keygen -t rsa -b 4096 -C "aliyun"
sudo apt-get install git
git clone git@github.com:YSMull/ysmull.github.com.git
nohup jekyll server &
sudo apt-get install nginx


```

## Nginx配置
### Nginx.conf
```
/etc/nginx/nginx.conf

server {
    listen  80;
    add_header Strict-Transport-Security max-age=15768000;
    server_name   ysmull.cn www.ysmull.cn;
    # server_name    123.207.108.34;
    return         301 https://$server_name$request_uri;
}
server {
    listen 443 ssl http2;
    server_name ysmull.cn www.ysmull.cn;
    location ~* \.(woff|css|js)$ {
        root /home/ubuntu/ysmull.github.com/_site/;
        expires 1h;
        add_header Pragma public;
        add_header Cache-Control "public";
        access_log off;
    }
    location / {
        proxy_pass http://0.0.0.0:4000;
        expires 1h;
        access_log off;
        add_header Pragma public;
        add_header Cache-Control "public";
    }
    ssl on;
    ssl_certificate /home/ubuntu/ssl/cert.crt;
    ssl_certificate_key /home/ubuntu/ssl/cert.key;
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2; #按照这个协议配置
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;#按照这个套件配置
    ssl_prefer_server_ciphers on;
    ssl_session_cache shared:SSL:32m;
    ssl_buffer_size 8k;
    ssl_session_tickets off;
    ssl_session_timeout 180m;
}
```

### 开启 gzip_static
```bash
ubuntu@VM-87-131-ubuntu:~$ ps ax | grep nginx
30558 ?        Ss     0:00 nginx: master process /usr/sbin/nginx -g daemon on; master_process on;
30559 ?        S      0:00 nginx: worker process
30788 pts/0    S+     0:00 grep --color=auto nginx
ubuntu@VM-87-131-ubuntu:~$ sudo strace -p 30559 2>&1 | grep gz
open("/home/ubuntu/ysmull.github.com/_site/assets/build/bundle.js.gz", O_RDONLY|O_NONBLOCK) = -1 ENOENT (No such file or directory)
open("/home/ubuntu/ysmull.github.com/_site/assets/font/ShadowsIntoLight.woff.gz", O_RDONLY|O_NONBLOCK) = 12
open("/home/ubuntu/ysmull.github.com/_site/assets/font/OpenSans.woff.gz", O_RDONLY|O_NONBLOCK) = 12
open("/home/ubuntu/ysmull.github.com/_site/assets/font/RobotSlabRegular.woff.gz", O_RDONLY|O_NONBLOCK) = 12
open("/home/ubuntu/ysmull.github.com/_site/assets/font/Inconsolata.woff.gz", O_RDONLY|O_NONBLOCK) = 12

```

http://gwokae.mewggle.com/wordpress/2010/08/%E8%B6%85%E6%98%93-%E5%85%A9%E8%A1%8C%E6%8C%87%E4%BB%A4%E6%90%9E%E5%AE%9A-linux-ssh%E7%99%BB%E5%85%A5%E5%85%8D%E5%AF%86%E7%A2%BC/
